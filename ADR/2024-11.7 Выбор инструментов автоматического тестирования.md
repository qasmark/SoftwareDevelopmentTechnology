**Дата:** 25 ноября 2024 г.

**Статус:** Принято

**Контекст:**

Для обеспечения качества и надежности системы геолокации необходимо внедрить автоматическое тестирование на различных уровнях: модульное (юнит), интеграционное и end-to-end (e2e). Выбор инструментов должен учитывать специфику проекта, используемые технологии, простоту использования, интеграцию с CI/CD системами и стоимость. Автоматизированное тестирование должно охватывать функциональные и нефункциональные требования, включая производительность (PER), безопасность (SEC), доступность (AVA), удобство использования (USA), надежность (DUR).

**Рассмотренные варианты:**

*   **Модульное (юнит) тестирование:**
    1. GoConvey: Фреймворк для написания и запуска юнит-тестов в Go.
    2. testify:  Библиотека Go для упрощения написания тестов и ассертов.
    3. GoMock:  Фреймворк для создания моков и стабов в Go.
*   **Интеграционное тестирование:**
    1. GoConvey/testify:  Могут использоваться для интеграционного тестирования.
    2. dockertest: Библиотека для запуска и управления Docker-контейнерами в тестах.
*   **End-to-end (e2e) тестирование:**
    1. Cypress: Фреймворк для e2e тестирования веб-приложений.
    2. Selenium:  Фреймворк для автоматизации веб-браузеров.
    3. K6:  Инструмент для нагрузочного тестирования.
    4. Playwright:  Node.js библиотека для e2e тестирования веб-приложений.

**Решение:**

*   **Модульное тестирование:**  **testify** + **GoMock**  — testify обеспечивает гибкость и простоту написания тестов, а GoMock позволяет эффективно работать с зависимостями.
*   **Интеграционное тестирование:**  **testify** + **dockertest**  —  dockertest  позволяет запускать тесты в изолированной среде с Docker-контейнерами, что обеспечивает надежность и повторяемость результатов.
*   **E2E тестирование:**  **Cypress** для тестирования веб-интерфейса и **K6** для нагрузочного тестирования — Cypress обеспечивает удобство и простоту написания e2e тестов для веб-интерфейса, а K6  —  мощный инструмент для нагрузочного тестирования и проверки производительности.

**Обоснование:**

*   **Простота использования и интеграция (USA01, DEV01):** Выбранные инструменты просты в использовании, хорошо интегрируются друг с другом и с CI/CD системами.
*   **Поддержка Go (DEV02):** testify и GoMock  специально разработаны для Go.
*   **Широкие возможности:** Cypress предоставляет богатый набор функций для тестирования веб-интерфейса, включая симуляцию пользовательских действий, проверку состояния DOM и сетевых запросов. K6 позволяет моделировать различные сценарии нагрузки и анализировать производительность системы. (PER04, SCA01)
*   **Надежность и повторяемость (DUR01, DUR02):** dockertest  обеспечивает изолированную среду для тестов, что повышает их надежность.
*   **Соответствие требованиям безопасности (SEC05):**  Автоматизированные тесты позволяют регулярно проверять безопасность системы. K6 может использоваться для нагрузочного тестирования и выявления уязвимостей, связанных с производительностью.
*   **Мониторинг (MON01):**  Результаты тестов могут интегрироваться с системами мониторинга.
*   **Ограничения (LIM01, LIM02, LIM03):** Выбранные инструменты имеют открытый исходный код и бесплатны для использования, что соответствует бюджетным ограничениям.

**Недостатки решения:**

*   **Зависимость от выбранных фреймворков:**  Переход на другие инструменты в будущем может потребовать значительных усилий.

**Последствия:**

*   Настройка инфраструктуры для запуска тестов (CI/CD).
*   Разработка тестовых сценариев для различных уровней тестирования.
*   Интеграция результатов тестов с системами мониторинга.
*   Обучение команды использованию выбранных инструментов.